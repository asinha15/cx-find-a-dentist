<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>{{title}}</title>

    {{#each stylesheets}}
    <link href="{{stylesheet}}" rel="stylesheet"/>
    {{/each}}

    <script type="text/javascript">
      (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o), m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
      })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
      ga('create', '{{google-al}}', 'auto');
      var dnt= navigator.doNotTrack || window.doNotTrack || window.msDoNotTrack;
      var newPathname = "";
      function setPath() {
        var pathArray = window.location.pathname.split( '/' );
        var searchArray = new URLSearchParams(window.location.search);
        var searchArrayLocation = searchArray.get("location");
        var loc = searchArrayLocation.slice(0, (searchArrayLocation.search(/\d/) -1));
        loc = loc.replace(/\s+/g, '-').replace(/,/g, '');
        var newPathStart = "find-a-dentist/alpha";
        if (pathArray[3] == "directory-search.html"){
          newPathname = newPathStart + "/search" + window.location.search;
        } else if (pathArray[3] == "provider-details.html") {
          if(searchArray.get("providerKey")){
            newPathname = newPathStart +"/"+ loc +"/provider/"+ searchArray.get("providerKey");
          } else {
            newPathname = newPathStart +"/"+ loc +"/provider/"+ window.location.search;
          }
        } else if (pathArray[3] == "facility-details.html" {
          if(searchArray.get("facilityId")) {
            newPathname = newPathStart +"/"+ loc +"/facility/"+ searchArray.get("facilityId");
          } else {
            newPathname = newPathStart +"/"+ loc +"/facility/"+ window.location.search;
          }
        } else if (pathArray[3] == "office-details.html" {
          if(searchArray.get("practiceLocationNumber")) {
            newPathname = newPathStart +"/"+ loc +"/office/"+ searchArray.get("practiceLocationNumber");
          } else {
            newPathname = newPathStart +"/"+ loc +"/office/"+ window.location.search;
          }
        } else {
            newPathname = newPathStart +"/"+ pathArray[3].replace(".html", "");
        }
      }
      setPath();
      ga('set', 'dimension9', dnt);
      ga('set', 'page', newPathname);
      ga('send', 'pageview');
    </script>

    {{#each blockingScripts}}
    <script src="{{script}}"></script>
    {{/each}}

  </head>
  <body>
    {{> (lookup . "body") }}
  </body>

  {{#each scripts}}
  <script src="{{script}}" defer="defer"></script>
  {{/each}}

</html>
